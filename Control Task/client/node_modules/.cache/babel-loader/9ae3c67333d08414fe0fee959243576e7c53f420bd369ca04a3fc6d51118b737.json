{"ast":null,"code":"import _defineProperty from\"C:/Users/Artiem/source/repos/vscode/3 \\u043A\\u0443\\u0440\\u0441/Control Task/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"C:/Users/Artiem/source/repos/vscode/3 \\u043A\\u0443\\u0440\\u0441/Control Task/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Artiem/source/repos/vscode/3 \\u043A\\u0443\\u0440\\u0441/Control Task/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _extraReducers;import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';import axios from'../../../utils/axios';var initialState={user:null,token:null,isLoading:false,status:null};export var registerUser=createAsyncThunk('auth/registerUser',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var username,password,_yield$axios$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:username=_ref.username,password=_ref.password;_context.prev=1;_context.next=4;return axios.post('/auth/register',{username:username,password:password});case 4:_yield$axios$post=_context.sent;data=_yield$axios$post.data;if(data.token){window.localStorage.setItem('token',data.token);}return _context.abrupt(\"return\",data);case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 13:case\"end\":return _context.stop();}},_callee,null,[[1,10]]);}));return function(_x){return _ref2.apply(this,arguments);};}());export var loginUser=createAsyncThunk('auth/loginUser',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref3){var username,password,_yield$axios$post2,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:username=_ref3.username,password=_ref3.password;_context2.prev=1;_context2.next=4;return axios.post('/auth/login',{username:username,password:password});case 4:_yield$axios$post2=_context2.sent;data=_yield$axios$post2.data;if(data.token){window.localStorage.setItem('token',data.token);}return _context2.abrupt(\"return\",data);case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}},_callee2,null,[[1,10]]);}));return function(_x2){return _ref4.apply(this,arguments);};}());export var getMe=createAsyncThunk('auth/loginUser',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.get('/auth/me');case 3:_yield$axios$get=_context3.sent;data=_yield$axios$get.data;return _context3.abrupt(\"return\",data);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 11:case\"end\":return _context3.stop();}},_callee3,null,[[0,8]]);})));export var authSlice=createSlice({name:'auth',initialState:initialState,reducers:{logout:function logout(state){state.user=null;state.token=null;state.isLoading=false;state.status=null;}},extraReducers:(_extraReducers={},_defineProperty(_extraReducers,registerUser.pending,function(state){state.isLoading=true;state.status=null;}),_defineProperty(_extraReducers,registerUser.fulfilled,function(state,action){state.isLoading=false;state.status=action.payload.message;state.user=action.payload.user;state.token=action.payload.token;}),_defineProperty(_extraReducers,registerUser.rejected,function(state,action){state.status=action.payload.message;state.isLoading=false;}),_defineProperty(_extraReducers,loginUser.pending,function(state){state.isLoading=true;state.status=null;}),_defineProperty(_extraReducers,loginUser.fulfilled,function(state,action){state.isLoading=false;state.status=action.payload.message;state.user=action.payload.user;state.token=action.payload.token;}),_defineProperty(_extraReducers,loginUser.rejected,function(state,action){state.status=action.payload.message;state.isLoading=false;}),_defineProperty(_extraReducers,getMe.pending,function(state){state.isLoading=true;state.status=null;}),_defineProperty(_extraReducers,getMe.fulfilled,function(state,action){var _action$payload,_action$payload2;state.isLoading=false;state.status=null;state.user=(_action$payload=action.payload)===null||_action$payload===void 0?void 0:_action$payload.user;state.token=(_action$payload2=action.payload)===null||_action$payload2===void 0?void 0:_action$payload2.token;}),_defineProperty(_extraReducers,getMe.rejected,function(state,action){state.status=action.payload.message;state.isLoading=false;}),_extraReducers)});export var checkIsAuth=function checkIsAuth(state){return Boolean(state.auth.token);};var logout=authSlice.actions.logout;export{logout};export default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","initialState","user","token","isLoading","status","registerUser","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","username","password","_yield$axios$post","data","wrap","_callee$","_context","prev","next","post","sent","window","localStorage","setItem","abrupt","t0","console","log","stop","_x","apply","arguments","loginUser","_ref4","_callee2","_ref3","_yield$axios$post2","_callee2$","_context2","_x2","getMe","_callee3","_yield$axios$get","_callee3$","_context3","get","authSlice","name","reducers","logout","state","extraReducers","_extraReducers","_defineProperty","pending","fulfilled","action","payload","message","rejected","_action$payload","_action$payload2","checkIsAuth","Boolean","auth","actions","reducer"],"sources":["C:/Users/Artiem/source/repos/vscode/3 курс/Control Task/client/src/redux/features/auth/authSlice.js"],"sourcesContent":["import {createSlice, createAsyncThunk} from '@reduxjs/toolkit'\r\nimport axios from '../../../utils/axios'\r\n\r\nconst initialState = {\r\n    user: null,\r\n    token: null,\r\n    isLoading: false, \r\n    status: null\r\n}\r\n\r\nexport const registerUser = createAsyncThunk('auth/registerUser', \r\n    async ({username, password}) => {\r\n        try{\r\n            const {data} = await axios.post('/auth/register', {\r\n                username,\r\n                password\r\n            })\r\n            if(data.token)\r\n            {\r\n                window.localStorage.setItem('token', data.token)\r\n            }\r\n            return data\r\n        }\r\n        catch(error){\r\n            console.log(error)\r\n        }\r\n})\r\n\r\nexport const loginUser = createAsyncThunk('auth/loginUser', \r\n    async ({username, password}) => {\r\n        try{\r\n            const {data} = await axios.post('/auth/login', {\r\n                username,\r\n                password\r\n            })\r\n            if(data.token)\r\n            {\r\n                window.localStorage.setItem('token', data.token)\r\n            }\r\n            return data\r\n        }\r\n        catch(error){\r\n            console.log(error)\r\n        }\r\n})\r\nexport const getMe = createAsyncThunk('auth/loginUser', \r\n    async () => {\r\n        try{\r\n            const {data} = await axios.get('/auth/me')\r\n            return data\r\n        }\r\n        catch(error){\r\n            console.log(error)\r\n        }\r\n})\r\n\r\n\r\nexport const authSlice = createSlice({\r\n    name: 'auth',\r\n    initialState,\r\n    reducers: {\r\n        logout: (state) =>\r\n        {\r\n            state.user = null\r\n            state.token = null\r\n            state.isLoading = false\r\n            state.status = null\r\n        },\r\n    },\r\n    extraReducers: {\r\n        [registerUser.pending]:(state)=>{\r\n            state.isLoading = true\r\n            state.status = null\r\n        },\r\n        [registerUser.fulfilled]:(state, action)=>{\r\n            state.isLoading = false\r\n            state.status = action.payload.message\r\n            state.user = action.payload.user\r\n            state.token  = action.payload.token\r\n        },\r\n        [registerUser.rejected]:(state, action)=>{\r\n            state.status = action.payload.message\r\n            state.isLoading = false\r\n        },\r\n        //\r\n        [loginUser.pending]:(state)=>{\r\n            state.isLoading = true\r\n            state.status = null\r\n        },\r\n        [loginUser.fulfilled]:(state, action)=>{\r\n            state.isLoading = false\r\n            state.status = action.payload.message\r\n            state.user = action.payload.user\r\n            state.token  = action.payload.token\r\n        },\r\n        [loginUser.rejected]:(state, action)=>{\r\n            state.status = action.payload.message\r\n            state.isLoading = false\r\n        },\r\n                //\r\n        [getMe.pending]:(state)=>{\r\n            state.isLoading = true\r\n            state.status = null\r\n        },\r\n        [getMe.fulfilled]:(state, action)=>{\r\n            state.isLoading = false\r\n            state.status = null\r\n            state.user = action.payload?.user\r\n            state.token  = action.payload?.token\r\n        },\r\n        [getMe.rejected]:(state, action)=>{\r\n            state.status = action.payload.message\r\n            state.isLoading = false\r\n        },\r\n    }\r\n})\r\n\r\nexport const checkIsAuth = state => Boolean(state.auth.token)\r\nexport const {logout} = authSlice.actions\r\nexport default authSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}